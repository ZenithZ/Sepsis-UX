/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { EventEmitter } from "@angular/core";
/**
 * @template Model
 */
var /**
 * @template Model
 */
Feature = /** @class */ (function () {
    function Feature(el) {
        this._settings = {};
        this._el = el;
        this.name = this.normalizeName(el.nativeElement.nodeName.toLowerCase());
        this.featureName = "igGrid" + this.name;
        for (var propt in jQuery.ui["igGrid" + this.name].prototype.events) {
            this[propt] = new EventEmitter();
        }
    }
    /**
     * @return {?}
     */
    Feature.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var self = this;
        this.initSettings = jQuery.extend(true, {}, this);
        /** @type {?} */
        var evtName;
        this._events = new Map();
        /** @type {?} */
        var grid = jQuery(this._el.nativeElement).closest("ig-grid").find("table");
        //event binding for features
        for (var propt in jQuery.ui[this.featureName].prototype.events) {
            evtName = this.featureName.toLowerCase() + propt.toLowerCase();
            this._events[evtName] = propt;
            jQuery(grid).on(evtName, (/**
             * @param {?} evt
             * @param {?} ui
             * @return {?}
             */
            function (evt, ui) {
                self[self._events[evt.type]].emit({ event: evt, ui: ui });
            }));
        }
        for (var setting in jQuery.ui[this.featureName].prototype.options) {
            Object.defineProperty(self, setting, {
                set: self.createFeatureSetter(setting),
                get: self.createFeatureGetter(setting),
                enumerable: true,
                configurable: true
            });
        }
        /** @type {?} */
        var propNames = Object.getOwnPropertyNames(jQuery.ui[this.featureName].prototype);
        for (var i = 0; i < propNames.length; i++) {
            /** @type {?} */
            var name = propNames[i];
            if (name.indexOf("_") !== 0 && typeof jQuery.ui[this.featureName].prototype[name] === "function") {
                Object.defineProperty(self, name, {
                    get: self.createMethodGetter(name)
                });
            }
        }
    };
    /**
     * @param {?} name
     * @return {?}
     */
    Feature.prototype.createFeatureSetter = /**
     * @param {?} name
     * @return {?}
     */
    function (name) {
        return (/**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            /** @type {?} */
            var grid = jQuery(this._el.nativeElement).closest("ig-grid").find("table[role='grid']");
            this._settings[name] = value;
            if (jQuery.ui[this.featureName] &&
                jQuery.ui[this.featureName].prototype.options &&
                jQuery.ui[this.featureName].prototype.options.hasOwnProperty(name) &&
                grid.data(this.featureName)) {
                grid[this.featureName]("option", name, value);
            }
        });
    };
    /**
     * @param {?} name
     * @return {?}
     */
    Feature.prototype.createFeatureGetter = /**
     * @param {?} name
     * @return {?}
     */
    function (name) {
        return (/**
         * @return {?}
         */
        function () {
            return this._settings[name];
        });
    };
    /**
     * @param {?} name
     * @return {?}
     */
    Feature.prototype.createMethodGetter = /**
     * @param {?} name
     * @return {?}
     */
    function (name) {
        return (/**
         * @return {?}
         */
        function () {
            /** @type {?} */
            var grid = jQuery(this._el.nativeElement).closest("ig-grid").find("table[role='grid']");
            if (grid.length === 0) {
                grid = jQuery(this._el.nativeElement).closest("ig-hierarchical-grid").find("table[role='grid']");
            }
            /** @type {?} */
            var args = [];
            /** @type {?} */
            var feature = grid.data(this.featureName);
            return jQuery.proxy(feature[name], feature);
        });
    };
    /**
     * @param {?} str
     * @return {?}
     */
    Feature.prototype.normalizeName = /**
     * @param {?} str
     * @return {?}
     */
    function (str) {
        //convert hyphen to camelCase
        /** @type {?} */
        var name = str.replace(/-([a-z])/g, (/**
         * @param {?} group
         * @return {?}
         */
        function (group) {
            return group[1].toUpperCase();
        }));
        return name.charAt(0).toUpperCase() + name.slice(1);
    };
    return Feature;
}());
/**
 * @template Model
 */
export { Feature };
if (false) {
    /** @type {?} */
    Feature.prototype._el;
    /** @type {?} */
    Feature.prototype._settings;
    /** @type {?} */
    Feature.prototype.initSettings;
    /** @type {?} */
    Feature.prototype.name;
    /**
     * @type {?}
     * @private
     */
    Feature.prototype._events;
    /**
     * @type {?}
     * @private
     */
    Feature.prototype.featureName;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmVhdHVyZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL2lnbml0ZXVpLWFuZ3VsYXItd3JhcHBlcnMvIiwic291cmNlcyI6WyJsaWIvaWdncmlkL2ZlYXR1cmUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBYyxZQUFZLEVBQUUsTUFBTSxlQUFlLENBQUM7Ozs7QUFJekQ7Ozs7SUFRSSxpQkFBWSxFQUFjO1FBTm5CLGNBQVMsR0FBUSxFQUFFLENBQUM7UUFPdkIsSUFBSSxDQUFDLEdBQUcsR0FBRyxFQUFFLENBQUM7UUFDZCxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxhQUFhLENBQUMsRUFBRSxDQUFDLGFBQWEsQ0FBQyxRQUFRLENBQUMsV0FBVyxFQUFFLENBQUMsQ0FBQztRQUN4RSxJQUFJLENBQUMsV0FBVyxHQUFHLFFBQVEsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDO1FBQ3hDLEtBQUssSUFBSSxLQUFLLElBQUksTUFBTSxDQUFDLEVBQUUsQ0FBQyxRQUFRLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLFNBQVMsQ0FBQyxNQUFNLEVBQUU7WUFDaEUsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7U0FDcEM7SUFDTCxDQUFDOzs7O0lBRUQsMEJBQVE7OztJQUFSOztZQUNRLElBQUksR0FBRyxJQUFJO1FBQ2YsSUFBSSxDQUFDLFlBQVksR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLElBQUksRUFBRSxFQUFFLEVBQUUsSUFBSSxDQUFDLENBQUM7O1lBQzlDLE9BQU87UUFDWCxJQUFJLENBQUMsT0FBTyxHQUFHLElBQUksR0FBRyxFQUFrQixDQUFDOztZQUNyQyxJQUFJLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsYUFBYSxDQUFDLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBQyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUM7UUFFMUUsNEJBQTRCO1FBQzVCLEtB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O0lBQ0wsY0FBQztBQUFELENBQUMsQUF6RkQsSUF5RkM7Ozs7Ozs7SUF4Rkcsc0JBQWdCOztJQUNoQiw0QkFBMkI7O0lBQzNCLCtCQUEyQjs7SUFDM0IsdUJBQW9COzs7OztJQUNwQiwwQkFBcUI7Ozs7O0lBQ3JCLDhCQUE0QiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEVsZW1lbnRSZWYsIEV2ZW50RW1pdHRlciB9IGZyb20gXCJAYW5ndWxhci9jb3JlXCI7XG5cbmRlY2xhcmUgdmFyIGpRdWVyeTogYW55O1xuXG5leHBvcnQgY2xhc3MgRmVhdHVyZTxNb2RlbD4ge1xuICAgIHB1YmxpYyBfZWw6IGFueTtcbiAgICBwdWJsaWMgX3NldHRpbmdzOiBhbnkgPSB7fTtcbiAgICBwdWJsaWMgaW5pdFNldHRpbmdzOiBNb2RlbDtcbiAgICBwdWJsaWMgbmFtZTogc3RyaW5nO1xuICAgIHByaXZhdGUgX2V2ZW50czogYW55O1xuICAgIHByaXZhdGUgZmVhdHVyZU5hbWU6IHN0cmluZztcblxuICAgIGNvbnN0cnVjdG9yKGVsOiBFbGVtZW50UmVmKSB7XG4gICAgICAgIHRoaXMuX2VsID0gZWw7XG4gICAgICAgIHRoaXMubmFtZSA9IHRoaXMubm9ybWFsaXplTmFtZShlbC5uYXRpdmVFbGVtZW50Lm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkpO1xuICAgICAgICB0aGlzLmZlYXR1cmVOYW1lID0gXCJpZ0dyaWRcIiArIHRoaXMubmFtZTtcbiAgICAgICAgZm9yICh2YXIgcHJvcHQgaW4galF1ZXJ5LnVpW1wiaWdHcmlkXCIgKyB0aGlzLm5hbWVdLnByb3RvdHlwZS5ldmVudHMpIHtcbiAgICAgICAgICAgIHRoaXNbcHJvcHRdID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgbmdPbkluaXQoKSB7XG4gICAgICAgIGxldCBzZWxmID0gdGhpcztcbiAgICAgICAgdGhpcy5pbml0U2V0dGluZ3MgPSBqUXVlcnkuZXh0ZW5kKHRydWUsIHt9LCB0aGlzKTtcbiAgICAgICAgbGV0IGV2dE5hbWU7XG4gICAgICAgIHRoaXMuX2V2ZW50cyA9IG5ldyBNYXA8c3RyaW5nLCBzdHJpbmc+KCk7XG4gICAgICAgIGxldCBncmlkID0galF1ZXJ5KHRoaXMuX2VsLm5hdGl2ZUVsZW1lbnQpLmNsb3Nlc3QoXCJpZy1ncmlkXCIpLmZpbmQoXCJ0YWJsZVwiKTtcblxuICAgICAgICAvL2V2ZW50IGJpbmRpbmcgZm9yIGZlYXR1cmVzXG4gICAgICAgIGZvciAodmFyIHByb3B0IGluIGpRdWVyeS51aVt0aGlzLmZlYXR1cmVOYW1lXS5wcm90b3R5cGUuZXZlbnRzKSB7XG4gICAgICAgICAgICBldnROYW1lID0gdGhpcy5mZWF0dXJlTmFtZS50b0xvd2VyQ2FzZSgpICsgcHJvcHQudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgIHRoaXMuX2V2ZW50c1tldnROYW1lXSA9IHByb3B0O1xuICAgICAgICAgICAgalF1ZXJ5KGdyaWQpLm9uKGV2dE5hbWUsIGZ1bmN0aW9uIChldnQsIHVpKSB7XG4gICAgICAgICAgICAgICAgc2VsZltzZWxmLl9ldmVudHNbZXZ0LnR5cGVdXS5lbWl0KHsgZXZlbnQ6IGV2dCwgdWk6IHVpIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgc2V0dGluZyBpbiBqUXVlcnkudWlbdGhpcy5mZWF0dXJlTmFtZV0ucHJvdG90eXBlLm9wdGlvbnMpIHtcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzZWxmLCBzZXR0aW5nLCB7XG4gICAgICAgICAgICAgICAgc2V0OiBzZWxmLmNyZWF0ZUZlYXR1cmVTZXR0ZXIoc2V0dGluZyksXG4gICAgICAgICAgICAgICAgZ2V0OiBzZWxmLmNyZWF0ZUZlYXR1cmVHZXR0ZXIoc2V0dGluZyksXG4gICAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHZhciBwcm9wTmFtZXMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhqUXVlcnkudWlbdGhpcy5mZWF0dXJlTmFtZV0ucHJvdG90eXBlKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wTmFtZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBuYW1lID0gcHJvcE5hbWVzW2ldO1xuICAgICAgICAgICAgaWYgKG5hbWUuaW5kZXhPZihcIl9cIikgIT09IDAgJiYgdHlwZW9mIGpRdWVyeS51aVt0aGlzLmZlYXR1cmVOYW1lXS5wcm90b3R5cGVbbmFtZV0gPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzZWxmLCBuYW1lLCB7XG4gICAgICAgICAgICAgICAgICAgIGdldDogc2VsZi5jcmVhdGVNZXRob2RHZXR0ZXIobmFtZSlcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGNyZWF0ZUZlYXR1cmVTZXR0ZXIobmFtZSkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICBsZXQgZ3JpZCA9IGpRdWVyeSh0aGlzLl9lbC5uYXRpdmVFbGVtZW50KS5jbG9zZXN0KFwiaWctZ3JpZFwiKS5maW5kKFwidGFibGVbcm9sZT0nZ3JpZCddXCIpO1xuICAgICAgICAgICAgdGhpcy5fc2V0dGluZ3NbbmFtZV0gPSB2YWx1ZTtcblxuICAgICAgICAgICAgaWYgKGpRdWVyeS51aVt0aGlzLmZlYXR1cmVOYW1lXSAmJlxuICAgICAgICAgICAgICAgIGpRdWVyeS51aVt0aGlzLmZlYXR1cmVOYW1lXS5wcm90b3R5cGUub3B0aW9ucyAmJlxuICAgICAgICAgICAgICAgIGpRdWVyeS51aVt0aGlzLmZlYXR1cmVOYW1lXS5wcm90b3R5cGUub3B0aW9ucy5oYXNPd25Qcm9wZXJ0eShuYW1lKSAmJlxuICAgICAgICAgICAgICAgIGdyaWQuZGF0YSh0aGlzLmZlYXR1cmVOYW1lKSkge1xuICAgICAgICAgICAgICAgIGdyaWRbdGhpcy5mZWF0dXJlTmFtZV0oXCJvcHRpb25cIiwgbmFtZSwgdmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgY3JlYXRlRmVhdHVyZUdldHRlcihuYW1lKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fc2V0dGluZ3NbbmFtZV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgY3JlYXRlTWV0aG9kR2V0dGVyKG5hbWUpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGxldCBncmlkID0galF1ZXJ5KHRoaXMuX2VsLm5hdGl2ZUVsZW1lbnQpLmNsb3Nlc3QoXCJpZy1ncmlkXCIpLmZpbmQoXCJ0YWJsZVtyb2xlPSdncmlkJ11cIik7XG4gICAgICAgICAgICBpZiAoZ3JpZC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICBncmlkID0galF1ZXJ5KHRoaXMuX2VsLm5hdGl2ZUVsZW1lbnQpLmNsb3Nlc3QoXCJpZy1oaWVyYXJjaGljYWwtZ3JpZFwiKS5maW5kKFwidGFibGVbcm9sZT0nZ3JpZCddXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgICAgIHZhciBmZWF0dXJlID0gZ3JpZC5kYXRhKHRoaXMuZmVhdHVyZU5hbWUpO1xuICAgICAgICAgICAgcmV0dXJuIGpRdWVyeS5wcm94eShmZWF0dXJlW25hbWVdLCBmZWF0dXJlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIG5vcm1hbGl6ZU5hbWUoc3RyKSB7XG4gICAgICAgIC8vY29udmVydCBoeXBoZW4gdG8gY2FtZWxDYXNlXG4gICAgICAgIGxldCBuYW1lID0gc3RyLnJlcGxhY2UoLy0oW2Etel0pL2csIGZ1bmN0aW9uIChncm91cCkge1xuICAgICAgICAgICAgcmV0dXJuIGdyb3VwWzFdLnRvVXBwZXJDYXNlKCk7XG4gICAgICAgIH0pXG4gICAgICAgIHJldHVybiBuYW1lLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgbmFtZS5zbGljZSgxKTtcbiAgICB9XG59Il19